<!--
Copyright 2024 The Go Authors. All rights reserved.
Use of this source code is governed by a BSD-style
license that can be found in the LICENSE file.
-->
<!doctype html>
<html>
  {{template "head" .}}
  <body>
	{{template "header" .}}
	{{template "overview-result" .}}
  </body>
</html>

{{define "show-rawoutput"}}
<div class="toggle" onclick="toggleRawOutput()">[show raw LLM output]</div>
<div id="rawoutput" class="start-hidden">
	<pre>{{.Overview.Overview}}</pre>
</div>
<script>
function toggleRawOutput() {
	var x = document.getElementById("rawoutput");
	toggle(x)
}
</script>
{{end}}


{{define "show-prompt"}}
<div class="toggle" onclick="togglePrompt()">[show prompt]</div>
<div id="prompt" class="start-hidden">
	<ul>
		{{- range .Overview.Prompt -}}
	<li>
		<pre>{{.}}</pre>
	</li>
		{{- end -}}
	</ul>
</div>
<script>
function togglePrompt() {
	var x = document.getElementById("prompt");
	toggle(x)
}
</script>
{{end}}

{{define "overview-result"}}
<div class="section" id="result">
{{- with .Error -}}
	<p>Error: {{.Error}}</p>
{{- else with .Result -}}
	<div class="result">
		<p><a href="{{.HTMLURL}}" target="_blank">{{.HTMLURL}}</a></p>
		<p><strong>{{.Title}}</strong></p>
		<p>author: {{.User.Login}} | state: {{.State}} | created: {{fmttime .CreatedAt}} | updated: {{fmttime .UpdatedAt}}{{with .TotalComments}} | total comments: {{.}}{{end}}</p>
		<p><a href="{{.Related}}" target="_blank">[Search for related issues]</a></p>
		<p>AI-generated overview of {{.Desc}}{{if .Overview.Cached}} (cached){{end}}:</p>
		<div id="overview">{{safehtml .Overview.Overview}}</div>
	</div>
	{{template "show-rawoutput" .}}
	{{template "show-prompt" .}}
{{- else }}
	{{if .Params.Query}}<p>No result.</p>{{end}}
{{- end}}
</div>
{{end}}